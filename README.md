<h1 align="center">
  Test PB
</h1>

### Установка и запуск приложения
1. `git clone https://github.com/ihorGr/test_pb.git`
2. `cd ./test_pb`
3. `make install` (предполагает наличие установленого Docker)

### Остановка приложения
1. `make stop`

### Запуск приложения
1. `make run`

## Api
### Получение курса криптовалюты  <br>
Получение курса криптовалюты за пределенный промежуток времени.

#### HTTP Request
`GET /api/get_prices?currency_pair={currency_pair}&from={from}&to={to}`

#### Параметры:<br>
-. `currency_pair` string (required) - валютная пара(прим. BTC-USD, BTC-EUR. и тд). Имеет строгий формат записи, 
3 символа в верхнем регистре одной валюты разделены знаком "-" с  3 символами в верхнем регистре другой валюты.<br>
-. `from` timestring (required) - дата старта диапазона, имеет строгий формат Y-m-d H:i:s<br>
-. `to` timestring (required) - дата конца диапазона, имеет строгий формат Y-m-d H:i:s<br>

Example: 
`/api/get_prices?currency_pair=BTC-USD&interval=ghw&from=2022-05-19 06:00:00&to=2022-05-19 10:10:00`

#### HTTP Response

Example:
```json 
{
    "data":
        {
            "currency_pair":"BTC-EUR",
            "prices":
                [
                    {"value":"25390.96","time":"2022-05-19 09:37:09"},
                    {"value":"27155.25","time":"2022-05-19 08:37:09"},
                    {"value":"24314.41","time":"2022-05-19 07:37:09"},
                    {"value":"25757.59","time":"2022-05-19 06:37:09"}
                ]
        }
}
```

## Source
Отвечает за получение данных с удаленного источника.
Осуществляется через запуск комманды в терминале. При выполнении комманды получаем текущий валютный курс всех активных пар и сохраняем в БД. 
Для получения курсов в определенные интервалы запускаем комманду через крон(с укразанием нужного интервала запуска).

Для разового получения - в php-cli контейнере выполнить:
```shell
php bin/console task-pb:get-cryptocurrency-price
```

## Storage
Отвечает за взаимодействие(запись/чтение) с хранилищем(БД). 